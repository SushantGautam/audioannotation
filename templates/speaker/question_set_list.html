{% extends "speaker/base.html" %}
{% load static %}
{% load i18n %}

{% block content %}
<style>
   #controls{
        display: none;
      }
    #formats{
        display: none;
      }
      
</style>

  <div>
    <span>{% trans 'Question Sets: ' %}</span>
  </div>
  {% for q_set in object_list %}
    <div class="row mt-3">
      <div class="col-10">{{ q_set }}</div>
      <div class="col-2">
        <button type="button" data-bs-toggle="modal" data-bs-target="#test_modal"
                data-qn_set_pk="{{ q_set.pk }}"
                class="btn btn-warning start_test_button">{% trans 'Start' %}</button>
      </div>
    </div>
  {% endfor %}
  <div id="controls">
    <button type="button" id="recordButton">Record</button>
    <button type="button" id="pauseButton" disabled>Pause</button>
    <button type="button" id="stopButton" disabled>Stop</button>
  </div>
  <div id="formats">Format: start recording to see sample rate</div>

  <!-- Modal -->
  <div class="modal fade" id="test_modal" data-bs-backdrop="static" data-bs-keyboard="false"
       tabindex="-1" aria-labelledby="test_modal_label" aria-hidden="true">
    <div class="modal-dialog modal-lg" style="height: 90%">
      <div class="modal-content" style="height: 90%">
        <div class="modal-header">
          <h5 class="modal-title" id="test_modal_label"></h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body" style="padding: 0" id="test_modal_body">
        </div>
        <!--
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button type="button" class="btn btn-primary">Understood</button>
        </div>
        -->
      </div>
    </div>
  </div>



{% endblock content %}

{% block scripts %}
  <script src="{% static 'js/recorder/recorder.js' %}"></script>
  <script src="{% static 'js/recorder/app.js' %}"></script>
  <script>
    $(".start_test_button").click(function(){
      let qn_set_pk = $(this).attr('data-qn_set_pk');
      $.ajax({
        type: "GET",
        url: `{% url 'speaker:exam_popup' %}?qn_set=${qn_set_pk}`,
        success: function (response){
           $("#test_modal_body").html(response);
        },
        error: function () {
          console.log('Error');
        },
        complete: function () {
          $(".loading-icon-ajax").fadeOut("fast");
        }
      });
    });
  </script>

{% endblock scripts %}