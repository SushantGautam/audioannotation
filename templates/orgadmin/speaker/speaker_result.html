{% extends "orgadmin/base.html" %}
{% load i18n %}

{% block styles %}
    <style>
        main {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        section {
            margin-block: 1rem;
        }

        .title {
            font-weight: 500;
        }

        .users {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(14rem, 1fr));
            gap: 1rem;
            background-color: white;
            /* padding-block: 1rem; */
        }

        .users a {
            all: unset;
            cursor: pointer;
        }

        .user-card:hover {
            background-color: #444444;
            color: #f0f0f0;
        }

        .user-card.active {
            background-color: #444444;
            color: #f0f0f0;
            box-shadow: 1px 1px 10px 2px rgba(0, 0, 0, 0.2);
        }

        .user-card {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            padding: 1rem 1.5rem;
            border-radius: 0.5rem;
            border: 2.5px solid lightgrey;
            transition: all 0.3s ease-in-out;
        }

        .user-card .right-side {
            display: flex;
            flex-direction: column;
        }

        .new-additions, .time {
            display: flex;
            flex-direction: column;
            padding: 0rem 0.45rem 0 0.25rem;
            font-size: 0.9rem;
            font-weight: 500;
            border-radius: 0.25rem;
            background-color: rgba(0, 0, 0, 0.05);
            color: #0ab2a9;
        }

        .count {
            font-weight: 600;
            font-size: 1.5rem;
        }


        td a {
            all: unset;
            cursor: pointer;
            font-weight: bold;
        }
        td a:hover {
            all: unset;
            cursor: pointer;
            font-weight: bold;
        }
    </style>
{% endblock %}

{% block content %}

    <section>
        <h2 class="my-3 title">{% trans 'Speaker Result' %}</h2>
        <div class="users">
            <a href="{{ request.url }}">
                <div class="user-card {% if not request.GET.status %}active{% endif %}">
                    <div class="right-side text-center">
                        <div>
                            <span class="count"> {{ tq_count }}</span>
                        </div>
                        <span class="title"> {% trans 'Total Questions' %}</span>
                    </div>
                </div>
            </a>
            <a href="{{ request.url }}?status=solved">
                <div class="user-card {% if request.GET.status == 'solved' %}active{% endif %}">
                    <div class="right-side">
                        <div>
                            <span class="count">{{ sq_count }}</span>
                        </div>
                        <span class="title"> {% trans 'Solved Questions' %}</span>
                    </div>
                </div>
            </a>
            <a href="{{ request.url }}?status=unsolved">
                <div class="user-card {% if request.GET.status == 'unsolved' %}active{% endif %}">
                    <div class="right-side">
                        <div>
                            <span class="count">{{ uq_count }}</span>
                        </div>
                        <span class="title"> {% trans 'Unsolved Questions' %}</span>
                    </div>
                </div>
            </a>
        </div>
    </section>

    <main class="users-list">
        <section class="table-section">
            <table class="table py-3" cellspacing="0" id="">

                <thead class="">
                <tr class="">
                    <th>{% trans "S. No." %}</th>
                    <th>{% trans "Question Code" %}</th>
                    <th>{% trans "Recorded Date" %}</th>
                    <th>{% trans "Recorded Time" %}</th>
                    <th>{% trans "File Size" %}</th>
                    <th>{% trans "Play" %}</th>
                </tr>
                </thead>

                <tbody>

                {% for question in total_question %}
                   <tr>
                   <td> {{ forloop.counter }}</td>
                   <td> {{ question.unique_code }}</td>
                   <td> {{ question.created_at|date:'Y-m-d' }}</td>
                   <td> {{ question.created_at|date:'h:m A' }}</td>
                   <td> {{ question.file_upload.size }}</td>
                   <td> Play </td>
                   </tr>
                {% endfor %}






                {% comment %}
                {% for speaker in object_list %}
                    <tr>
                        <td> {{ forloop.counter }}</td>
                        <td>
                            <a href="{{ speaker.get_absolute_url }}">
                                {{ speaker.user.email }}
                            </a>
                        </td>
                        <td> {{ speaker.user.get_full_name }}</td>
                        <td> {{ speaker.organization_code }}</td>
                        <td> {{ speaker.get_nationality_display }}</td>
                        <td> {{ speaker.get_level_display }}</td>
                        <td>
                            <span class="active-status">
{#                                {{ speaker.user.is_active|yesno:'Active, Inactive' }}#}
                              {{ speaker.speaker_status }}
                            </span>
                        </td>
                        <td>
                            <span class="verification-status d-flex gap-2">
{#                             {% if speaker.is_verified %}#}
{#                                    {% trans 'Verified' %}#}
                              {% if speaker.get_verification_status == "Pending" %}
                                    {% trans 'Not Submitted yet' %}

                                {% elif speaker.speaker_status == "Profile Submitted" %}
                                    <form name="verify-form" action="{% url 'speaker_verify' user_id=speaker.id %}"
                                          method="post">
                                        {% csrf_token %}
                                        <input type="hidden" value="1" name="is_approved">
                                        <button class="btn btn-dark btn-sm verify-btn">{% trans 'Verify' %}</button>
                                    </form>
                                    <form name="verify-form" action="{% url 'speaker_verify' user_id=speaker.id %}"
                                          method="post">
                                        {% csrf_token %}
                                        <input type="hidden" value="0" name="is_approved">
                                        <button class="btn btn-dark btn-sm verify-btn">{% trans 'Reject' %}</button>
                                    </form>

                              {% elif speaker.speaker_status == 'Waiting For Agreement' %}

                              {% elif speaker.speaker_status == 'Recording Completed' %}
                                 <button class="btn btn-sm btn-primary">{% trans 'Send To STT' %}</button>
                                <button class="btn btn-sm btn-secondary">{% trans 'Result' %}</button>
                              {% elif speaker.speaker_status == 'Recording' %}
                                  {% trans 'Result' %}
                                {% elif speaker.speaker_status == 'Finished' %}
                            <button class="btn btn-sm btn-secondary">{% trans 'Result' %}</button>
                                {% else %}


                                {% endif %}
                            </span>
                        </td>

                    </tr>
                {% endfor %}
                {% endcomment %}
                </tbody>

            </table>
        </section>

    </main>

{% endblock %}

{% block scripts %}
    <script>
      {% comment %}

        $('.table').DataTable();

        $('form[name=verify-form]').on('submit', function (e) {
            e.preventDefault();
            var $form = $(this);
            $.ajax({
                type: $(this).attr('method'),
                url: $(this).attr('action'),
                data: $(this).serialize(),
                success: function (response) {
                    $form.closest('tr').find('.verification-status').text("{% trans 'Verified' %}");
                    $form.remove();
                }
            });
        });

        $('form[name=block-form]').on('submit', function (e) {
            e.preventDefault();
            var $form = $(this);
            $.ajax({
                type: $(this).attr('method'),
                url: $(this).attr('action'),
                data: $(this).serialize(),
                success: function (response) {
                    $form.closest('tr').find('.active-status').text("{% trans 'Inactive' %}");
                    $form.find('button').text('{% trans 'Unblock' %}')
                }
            });
        });

        $('form[name=unblock-form]').on('submit', function (e) {
            e.preventDefault();
            var $form = $(this);
            $.ajax({
                type: $(this).attr('method'),
                url: $(this).attr('action'),
                data: $(this).serialize(),
                success: function (response) {
                    $form.closest('tr').find('.active-status').text("{% trans 'Active' %}");
                    $form.find('button').text('{% trans 'Block' %}')
                }
            });
        });

        {% endcomment %}
    </script>
{% endblock scripts %}